<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAD Simulator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div class="container">
        <div class="resources-grid" id="bingoGrid">
            <h3>All Resources</h3>
            <div class="bingo-items-container">
            <div class="bingo-item" id="LGARALU2">LGARALU2</div>
            <div class="bingo-item" id="LGARALU7">LGARALU7</div>
            <div class="bingo-item" id="LGARALU9">LGARALU9</div>
            <div class="bingo-item" id="LGB31">LGB31</div>
            <div class="bingo-item" id="LGB32">LGB32</div>
            <div class="bingo-item" id="LGBOMBA1">LGBOMBA1</div>
            <div class="bingo-item" id="LGBOMBA7">LGBOMBA7</div>
            <div class="bingo-item" id="LGBORMT1">LGBORMT1</div>
            <div class="bingo-item" id="LGBORMT7">LGBORMT7</div>
            <div class="bingo-item" id="LGBUNGEP">LGBUNGEP</div>
            <div class="bingo-item" id="LGBUNGE1">LGBUNGE1</div>
            <div class="bingo-item" id="LGBUNGE7">LGBUNGE7</div>
            <div class="bingo-item" id="LGBUSA">LGBUSA</div>
            <div class="bingo-item" id="LGBUSB">LGBUSB</div>
            <div class="bingo-item" id="LGBUSC">LGBUSC</div>
            <div class="bingo-item" id="LGCAPFL1">LGCAPFL1</div>
            <div class="bingo-item" id="LGCAPFL7">LGCAPFL7</div>
            <div class="bingo-item" id="LGCAPFL9">LGCAPFL9</div>
            <div class="bingo-item" id="LGCARWO1">LGCARWO1</div>
            <div class="bingo-item" id="LGCARWO7A">LGCARWO7A</div>
            <div class="bingo-item" id="LGCARWO7B">LGCARWO7B</div>
            <div class="bingo-item" id="LGCHARL2">LGCHARL2</div>
            <div class="bingo-item" id="LGCHARL7">LGCHARL7</div>
            <div class="bingo-item" id="LGCMDJ">LGCMDJ</div>
            <div class="bingo-item" id="LGCMDK">LGCMDK</div>
            <div class="bingo-item" id="LGLAKEGE1">LGLAKEGE1</div>
            <div class="bingo-item" id="LGLAKEGE6">LGLAKEGE6</div>
            <div class="bingo-item" id="LGDO">LGDO</div>
            <div class="bingo-item" id="LGDOSUP1">LGDOSUP1</div>
            <div class="bingo-item" id="LGDOSUP2">LGDOSUP2</div>
            <div class="bingo-item" id="LGDOSUP3">LGDOSUP3</div>
            <div class="bingo-item" id="LGDOSUP4">LGDOSUP4</div>
            <div class="bingo-item" id="LGFARRI1">LGFARRI1</div>
            <div class="bingo-item" id="LGFARRI7">LGFARRI7</div>
            <div class="bingo-item" id="LGFCO1">LGFCO1</div>
            <div class="bingo-item" id="LGFCO2">LGFCO2</div>
            <div class="bingo-item" id="LGFCO41">LGFCO41</div>
            <div class="bingo-item" id="LGFCO42">LGFCO42</div>
            <div class="bingo-item" id="LGFCO43">LGFCO43</div>
            <div class="bingo-item" id="LGFCO51">LGFCO51</div>
            <div class="bingo-item" id="LGG1">LGG1</div>
            <div class="bingo-item" id="LGG2">LGG2</div>
            <div class="bingo-item" id="LGG3">LGG3</div>
            <div class="bingo-item" id="LGG4">LGG4</div>
            <div class="bingo-item" id="LGHOSKI1">LGHOSKI1</div>
            <div class="bingo-item" id="LGHOSKI7">LGHOSKI7</div>
            <div class="bingo-item" id="LGHOSKI9">LGHOSKI9</div>
            <div class="bingo-item" id="LGJERCR1">LGJERCR1</div>
            <div class="bingo-item" id="LGJERCR7A">LGJERCR7A</div>
            <div class="bingo-item" id="LGJERCR9">LGJERCR9</div>
            <div class="bingo-item" id="LGJERCRP">LGJERCRP</div>
            <div class="bingo-item" id="LGKRAWA1">LGKRAWA1</div>
            <div class="bingo-item" id="LGKRAWA7">LGKRAWA7</div>
            <div class="bingo-item" id="LGKRAWA9">LGKRAWA9</div>
            <div class="bingo-item" id="LGLOGISA">LGLOGISA</div>
            <div class="bingo-item" id="LGLOGISB">LGLOGISB</div>
            <div class="bingo-item" id="LGLOGISC">LGLOGISC</div>
            <div class="bingo-item" id="LGLOGISD">LGLOGISD</div>
            <div class="bingo-item" id="LGMAJCR2">LGMAJCR2</div>
            <div class="bingo-item" id="LGMAJCR7">LGMAJCR7</div>
            <div class="bingo-item" id="LGMONGA1">LGMONGA1</div>
            <div class="bingo-item" id="LGMONGA7">LGMONGA7</div>
            <div class="bingo-item" id="LGMULLO1">LGMULLO1</div>
            <div class="bingo-item" id="LGMULLO7">LGMULLO7</div>
            <div class="bingo-item" id="LGNERRI1">LGNERRI1</div>
            <div class="bingo-item" id="LGNERRI7">LGNERRI7</div>
            <div class="bingo-item" id="LGNERRI9">LGNERRI9</div>
            <div class="bingo-item" id="LGOCV">LGOCV</div>
            <div class="bingo-item" id="LGQUEAN1">LGQUEAN1</div>
            <div class="bingo-item" id="LGQUEAN7A">LGQUEAN7A</div>
            <div class="bingo-item" id="LGQUEAN7B">LGQUEAN7B</div>
            <div class="bingo-item" id="LGQUEAN9">LGQUEAN9</div>
            <div class="bingo-item" id="LGWAMBO1A">LGWAMBO1A</div>
            <div class="bingo-item" id="LGWAMBO1B">LGWAMBO1B</div>
            <div class="bingo-item" id="LGWAMBO7A">LGWAMBO7A</div>
            <div class="bingo-item" id="LGWAMBO7B">LGWAMBO7B</div>
        </div>
    </div>
        
        <div class="log-section">
            <h3>Log</h3>
            <div id="log"></div>
        </div>

        <div class="command-section">
            <input type="text" id="commandInput" placeholder="Enter command..." autofocus>
            <button onclick="processCommand()">Submit</button>
        </div>
    </div>

    <script>
        window.onload = () => {
            const resources = document.querySelectorAll('.bingo-item');
            resources.forEach(item => item.style.backgroundColor = 'grey');
        };

        function processCommand() {
    const commandInput = document.getElementById("commandInput");
    const log = document.getElementById("log");
    const commandText = commandInput.value.trim();

    if (commandText !== "") {
        const parsedCommands = interpretCommand(commandText);
        const timestamp = getCurrentTime(); // Get the current time

        parsedCommands.forEach(logMessage => {
            const logEntry = document.createElement("div");
            logEntry.innerHTML = `[${timestamp}] ${highlightUnits(logMessage)}`; // Highlight units in the log
            log.prepend(logEntry); // Add new logs to the top
        });

        commandInput.value = "";
    }
}

function getCurrentTime() {
    const now = new Date();
    const hours = String(now.getHours()).padStart(2, '0');
    const minutes = String(now.getMinutes()).padStart(2, '0');
    const seconds = String(now.getSeconds()).padStart(2, '0');
    return `${hours}:${minutes}:${seconds}`; // Format HH:MM:SS
}

function highlightUnits(logMessage) {
    // Regex to find unit identifiers that start with "LG"
    const unitRegex = /\b(LG[A-Z0-9]*)\b/g;
    return logMessage.replace(
        unitRegex,
        '<span class="highlight-unit">$1</span>'
    );
}



        function interpretCommand(command) {
            const [callsignsPart, commandType, statusOrMessage] = command.split('/');
            const callsigns = callsignsPart.split(',');

            const logMessages = [];

            if (commandType === 'S') {
                const statusString = getStatusString(statusOrMessage);
                callsigns.forEach(callsign => {
                    updateResourceStatus(callsign.trim(), statusOrMessage);
                    logMessages.push(`${callsign.trim()}: Status updated to ${statusString}`);
                });
            }

            if (commandType === 'M') {
                const cleanedMessage = statusOrMessage.split(';')[0].trim();
                callsigns.forEach(callsign => {
                    logMessages.push(`${callsign.trim()}: ${cleanedMessage}`);
                });
            }

            return logMessages;
        }

        function getStatusString(status) {
            const statusMap = {
                '1': 'responding',
                '3': 'on scene',
                '4': 'available',
                '5': 'at station',
                'AL': 'alerted'
            };
            return statusMap[status] || 'unknown';
        }

        function updateResourceStatus(callsign, status) {
            const resourceElement = document.getElementById(callsign);
            if (!resourceElement) return;

            const statusColors = {
                '1': 'yellow',
                '3': 'black',
                '4': 'green',
                '5': 'grey',
                'AL': 'blue'
            };

            resourceElement.style.backgroundColor = statusColors[status] || 'grey';
            resourceElement.style.color = status === '3' ? 'white' : 'black';
        }
    </script>

</body>
</html>
